<!doctype html><html class=no-js lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>Build Your First AWS DeepRacer Model - Coding N Concepts</title><script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script><meta name=description content="Guide to build your first AWS DeepRacer Model including reward function code."><meta property="og:title" content="Build Your First AWS DeepRacer Model"><meta property="og:description" content="Guide to build your first AWS DeepRacer Model including reward function code."><meta property="og:type" content="article"><meta property="og:url" content="https://codingnconcepts.com/aws/aws-deepracer/"><meta property="og:image" content="https://codingnconcepts.com/img/logo/aws.png"><meta property="article:published_time" content="2020-06-22T00:00:00+00:00"><meta property="article:modified_time" content="2020-06-22T00:00:00+00:00"><meta property="og:site_name" content="CodingNConcepts"><meta property="article:author" content="https://www.facebook.com/codingnconcepts"><meta property="article:publisher" content="https://www.facebook.com/codingnconcepts"><meta property="article:section" content="aws"><meta property="article:tag" content="AWS"><meta property="article:tag" content="Popular Posts"><meta property="fb:admins" content="177784346770196"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://codingnconcepts.com/img/logo/aws.png"><meta name=twitter:title content="Build Your First AWS DeepRacer Model"><meta name=twitter:description content="Guide to build your first AWS DeepRacer Model including reward function code."><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700|Rowdies"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico><link rel=canonical href=https://codingnconcepts.com/aws/aws-deepracer/><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-160024498-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"aws","name":"Build Your First AWS DeepRacer Model","headline":"Build Your First AWS DeepRacer Model","alternativeHeadline":null,"description":"Guide to build your first AWS DeepRacer Model including reward function code.","inLanguage":"en-us","isFamilyFriendly":true,"mainEntityOfPage":{"@type":"WebPage","@id":"https://codingnconcepts.com/aws/aws-deepracer/"},"author":{"@type":"Person","name":"Ashish Lahoti"},"creator":{"@type":"Person","name":"Ashish Lahoti"},"accountablePerson":{"@type":"Person","name":"Ashish Lahoti"},"copyrightHolder":"Coding N Concepts","copyrightYear":"2020","dateCreated":"2020-06-22T00:00:00.00Z","datePublished":"2020-06-22T00:00:00.00Z","dateModified":"2020-06-22T00:00:00.00Z","publisher":{"@type":"Organization","name":"Coding N Concepts","url":"https://codingnconcepts.com/","logo":{"@type":"ImageObject","url":"https://codingnconcepts.com/logo-amp.png","width":600,"height":60}},"image":["https://codingnconcepts.com/img/logo/aws.png"],"url":"https://codingnconcepts.com/aws/aws-deepracer/","wordCount":2183,"genre":["AWS","Popular Posts"],"keywords":null}</script></head><body class=body><div class="container container--outer"><header class=header><div class=container><div class=logo><a class=logo__link href=/ title="Coding N Concepts" rel=home><div class=logo__title><img src=/favicon-32x32.png alt="Build Your First AWS DeepRacer Model"> Coding N Concepts</div><div class=logo__tagline>Ashish Lahoti's Technical Blog</div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/tags/popular-posts><span class=menu__text>Popular</span></a></li><li class="menu__item menu__dropdown"><a class=menu__link href=/java/><span class=menu__text>Java</span>
<label class=drop-icon for=Java>▾</label></a>
<input type=checkbox id=Java><ul class=submenu__list><li class=menu__item><a class=menu__link href=/tags/java-core/><span class=menu__text>Core Java</span></a></li><li class=menu__item><a class=menu__link href=/tags/java-collection/><span class=menu__text>Collections</span></a></li><li class=menu__item><a class=menu__link href=/tags/java-design-pattern/><span class=menu__text>Design Patterns</span></a></li><li class=menu__item><a class=menu__link href=/tags/java-recursive/><span class=menu__text>Recursive</span></a></li><li class=menu__item><a class=menu__link href=/tags/java-streams/><span class=menu__text>Streams</span></a></li><li class=menu__item><a class=menu__link href=/tags/java-string/><span class=menu__text>String</span></a></li><li class=menu__item><a class=menu__link href=/tags/java-numbers/><span class=menu__text>Numbers</span></a></li><li class=menu__item><a class=menu__link href=/tags/java-threads/><span class=menu__text>Threads</span></a></li></ul></li><li class="menu__item menu__dropdown"><a class=menu__link href=/javascript/><span class=menu__text>JavaScript</span>
<label class=drop-icon for=JavaScript>▾</label></a>
<input type=checkbox id=JavaScript><ul class=submenu__list><li class=menu__item><a class=menu__link href=/tags/javascript-core/><span class=menu__text>JS Core</span></a></li><li class=menu__item><a class=menu__link href=/tags/javascript-object/><span class=menu__text>JS Object</span></a></li><li class=menu__item><a class=menu__link href=/tags/javascript-string/><span class=menu__text>JS String</span></a></li><li class=menu__item><a class=menu__link href=/tags/javascript-array/><span class=menu__text>JS Array</span></a></li><li class=menu__item><a class=menu__link href=/tags/javascript-console/><span class=menu__text>JS Console</span></a></li><li class=menu__item><a class=menu__link href=/tags/javascript-es6/><span class=menu__text>ES6</span></a></li></ul></li><li class="menu__item menu__dropdown"><a class=menu__link href=/spring-boot/><span class=menu__text>Spring Boot</span>
<label class=drop-icon for="Spring Boot">▾</label></a>
<input type=checkbox id="Spring Boot"><ul class=submenu__list><li class=menu__item><a class=menu__link href=/tags/spring-boot-basics/><span class=menu__text>Spring Boot Basics</span></a></li><li class=menu__item><a class=menu__link href=/tags/spring-boot-rest/><span class=menu__text>Spring Boot REST</span></a></li><li class=menu__item><a class=menu__link href=/tags/spring-boot-kafka/><span class=menu__text>Spring Boot KAFKA</span></a></li></ul></li><li class="menu__item menu__dropdown"><a class=menu__link href=/puzzle/><span class=menu__text>Puzzles</span>
<label class=drop-icon for=Puzzles>▾</label></a>
<input type=checkbox id=Puzzles><ul class=submenu__list><li class=menu__item><a class=menu__link href=/tags/maths-puzzle/><span class=menu__text>Maths Puzzles</span></a></li><li class=menu__item><a class=menu__link href=/tags/weight-puzzle/><span class=menu__text>Weight Puzzles</span></a></li></ul></li><li class="menu__item menu__dropdown"><a class=menu__link href=/interview-questions/><span class=menu__text>Interview Q&A</span>
<label class=drop-icon for="Interview Q&A">▾</label></a>
<input type=checkbox id="Interview Q&A"><ul class=submenu__list><li class=menu__item><a class=menu__link href=/tags/java-qa/><span class=menu__text>Java</span></a></li><li class=menu__item><a class=menu__link href=/tags/javascript-qa/><span class=menu__text>JavaScript</span></a></li><li class=menu__item><a class=menu__link href=/tags/css-qa/><span class=menu__text>CSS</span></a></li><li class=menu__item><a class=menu__link href=/tags/spring-qa/><span class=menu__text>Spring</span></a></li><li class=menu__item><a class=menu__link href=/tags/microservice-qa/><span class=menu__text>Microservices</span></a></li></ul></li><li class=menu__item><a class=menu__link href=/hugo/><span class=menu__text>Hugo</span></a></li><li class=menu__item><a class=menu__link href=/about/><span class=menu__text>About Me</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title><img class=post__thumbnail src=/img/logo/aws.png alt="Build Your First AWS DeepRacer Model"> Build Your First AWS DeepRacer Model</h1><div class="post__meta meta"><div class="meta__item-author meta__item"><svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2.0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class=meta__text>Ashish Lahoti</span></div><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2020-06-22T00:00:00Z>June 22, 2020</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/aws/ rel=category>AWS</a></span></div></div></header><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#prerequisite>Prerequisite</a></li><li><a href=#what-is-aws-deepracer>What is AWS DeepRacer?</a><ul><li><a href=#reinforcement-learning>Reinforcement learning</a></li><li><a href=#reward-function>Reward function</a></li></ul></li><li><a href=#1-getting-started>1. Getting Started</a></li><li><a href=#2-build-your-car>2. Build your Car</a><ul><li><a href=#action-space>Action Space</a></li></ul></li><li><a href=#3-create-model>3. Create Model</a><ul><li><a href=#reward-graph>Reward Graph</a></li><li><a href=#hyperparameters>Hyperparameters</a></li></ul></li><li><a href=#personal-experience>Personal Experience</a></li></ul></nav></div></div><div class="content post__content clearfix"><p>This step-by-step guide is helpful for beginners trying their hands on machine learning and creating their first AWS DeepRacer model.</p><h2 id=prerequisite>Prerequisite</h2><p>You should have a valid AWS account. If you haven&rsquo;t registered to AWS already, follow this <a href=https://codingnconcepts.com/aws/how-to-create-aws-account/>Step-by-step guide to create an AWS Account</a></p><h2 id=what-is-aws-deepracer>What is AWS DeepRacer?</h2><p>AWS DeepRacer is an exciting way for developers to get hands-on experience with machine learning.</p><p>In AWS DeepRacer, you use a 1/18 scale autonomous car equipped with sensors and cameras. You can use this car in virtual simulator, to train and evaluate. The same car is used in physical AWS DeepRacer global racing league.</p><p>In AWS DeepRacer, You do this:</p><ul><li>build your car, or choose existing one,</li><li>create your own <strong>reinforcement learning</strong> model, or choose from sample models,</li><li>choose pre-defined racing track,</li><li>train and evaluate your car on racing track using your model , and</li><li>finally you compete with others.<br><br></li></ul><h3 id=reinforcement-learning>Reinforcement learning</h3><blockquote><p><strong>Reinforcement learning (RL)</strong> is an area of machine learning concerned with how an <strong>agents</strong> should take <strong>actions</strong> in an <strong>environment</strong> in order to maximize the notion of cumulative <strong>reward</strong>. Reinforcement learning is one of three basic machine learning paradigms, alongside supervised learning and unsupervised learning.</p></blockquote><p>Let&rsquo;s understand the reinforcement learning key terms from AWS DeepRacer perspective:</p><figure class=center><img src=/img/aws/aws-deepracer-key-terms.png alt="AWS DeepRacer Key Terms"><figcaption><p>AWS DeepRacer Key Terms</p></figcaption></figure><ul><li><strong>model</strong> is created when you choose a car, racing track and write your reward function.</li><li><strong>agent</strong> is your Car</li><li><strong>action space</strong> is the amount of choices a Car has, for e.g., turn left, turn right, move forward at different speeds.</li><li><strong>state</strong> is position of Car on the track at a point of time.</li><li><strong>environment</strong> is the Racing Track of your Car</li><li><strong>reward function</strong> is a function written in python which returns reward in floating point number. Your car use this reward function in its training and try to accumulate more reward points</li><li><strong>training phase</strong> is when you train your car on racing track using the model you created.<br>Also known as <em>exploration phase</em> where your car explore the racing track, and learn from which route it can get more reward points.</li><li><strong>evaluating phase</strong> is when you evaluate your car after training is completed whether its able to complete the racing track or not.
Also known as <em>exploitation phase</em> where your car exploit the learning from training and try to reach the <strong>convergence</strong> (finish line).</li><li>The <strong>hyper parameters</strong> are reinforcement algorithm and training specific parameters which controls the car training process.</li><li>You car make attempts to find the best route by accumulating reward point in training phase. Attempt starts either from the start line or any part of the track. Attempt ends when car reaches the finish line, or loose the track, or crash. Each of this attempt is called an <strong>episode</strong>.<br><br></li></ul><h3 id=reward-function>Reward function</h3><p>Reward function is a python function where you give higher reward points for good behavior and lower reward points for bad behavior.</p><p>Here is sample reward function written in python which gives higher reward points to car for keeping it wheels on track:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>reward_function</span>(params):

    <span style=color:#75715e># Read input parameters</span>
    all_wheels_on_track <span style=color:#f92672>=</span> params[<span style=color:#e6db74>&#39;all_wheels_on_track&#39;</span>]
        
    <span style=color:#66d9ef>if</span> all_wheels_on_track:
        reward <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>   <span style=color:#75715e># higher reward for car to be on track</span>
    <span style=color:#66d9ef>else</span> 
        reward <span style=color:#f92672>=</span> <span style=color:#ae81ff>1e-3</span>  <span style=color:#75715e># lower reward for car to go outside track</span>
  
    <span style=color:#66d9ef>return</span> float(reward)
</code></pre></div><p>When you train your car, it attempts to run at different angles and speed on the track and try to accumulate reward points. In each subsequent attempts, it learns from its previous attempts and try to accumulate more reward points by keeping it wheels on track.</p><h2 id=1-getting-started>1. Getting Started</h2><p>① Go to <code>AWS Services</code> ➞ <code>AWS DeepRacer</code> ➞ <code>Reinforcement Learning</code> ➞ <code>Get Started</code></p><p>② If it is your first time, you will see some errors. Don&rsquo;t worry. Choose <span style="background-color:#ec7211;border:1px solid;border-radius:3px;font-weight:500;border-color:#e76d0c #e15500 #e15500;text-shadow:rgba(0,0,0,.05)0 1px 0;background-image:linear-gradient(180deg,#f67c1b 0,#e15500);box-shadow:inset 0 1px 0 hsla(0,0%,100%,.2);color:#ffff;padding:0 5px;font-weight:700">Reset Resources</span> and everything will be fine.</p><figure class=center><img src=/img/aws/aws-deepracer-get-started.png alt="AWS DeepRacer Get Started"><figcaption><p>AWS DeepRacer Get Started</p></figcaption></figure><p>This takes about 5 minutes. AWS internally does following things for you:</p><ol><li>Check IAM roles required for DeepRacer,</li><li>Check AWS DeepRacer resource stack:<ul><li><strong>Amazon SageMaker and AWS RoboMaker</strong> are the brain behind training your model</li><li><strong>Amazon S3</strong> to store samples and the new models created by you</li><li><strong>Amazon Kinesis Video Streams</strong> for streaming data and simulation video, when your car is training and evaluating</li><li><strong>Amazon CloudWatch</strong> to store and analyze the logs and metrics</li></ul></li></ol><p>You should be well-aware of the AWS services involved in AWS DeepRacer in order to understand the billing when AWS charge you money. Here is the AWS DeepRacer Simulator Architecture:</p><figure class=center><img src=/img/aws/aws-deepracer-simulator-architecture.png alt="AWS DeepRacer Simulator Architecture"><figcaption><p>AWS DeepRacer Simulator Architecture</p></figcaption></figure><h2 id=2-build-your-car>2. Build your Car</h2><p>You can either use the default Car <strong>The Original DeepRacer</strong> or build a new vehicle by following these steps:</p><p>① Go to <code>AWS DeepRacer</code> ➞ <code>Reinforcement Learning</code> ➞ <code>Your garage</code> and Choose <span style="background-color:#ec7211;border:1px solid;border-radius:3px;font-weight:500;border-color:#e76d0c #e15500 #e15500;text-shadow:rgba(0,0,0,.05)0 1px 0;background-image:linear-gradient(180deg,#f67c1b 0,#e15500);box-shadow:inset 0 1px 0 hsla(0,0%,100%,.2);color:#ffff;padding:0 5px;font-weight:700">Build New Vehicle</span></p><p>② Keep the default setting of Camera and Sensors. Choose <span style="background-color:#ec7211;border:1px solid;border-radius:3px;font-weight:500;border-color:#e76d0c #e15500 #e15500;text-shadow:rgba(0,0,0,.05)0 1px 0;background-image:linear-gradient(180deg,#f67c1b 0,#e15500);box-shadow:inset 0 1px 0 hsla(0,0%,100%,.2);color:#ffff;padding:0 5px;font-weight:700">Next</span></p><p>③ Keep the action space settings as below. Choose <span style="background-color:#ec7211;border:1px solid;border-radius:3px;font-weight:500;border-color:#e76d0c #e15500 #e15500;text-shadow:rgba(0,0,0,.05)0 1px 0;background-image:linear-gradient(180deg,#f67c1b 0,#e15500);box-shadow:inset 0 1px 0 hsla(0,0%,100%,.2);color:#ffff;padding:0 5px;font-weight:700">Next</span><figure class=center><img src=/img/aws/aws-deepracer-action-space.png alt="AWS DeepRacer Action Space for Beginners"><figcaption><p>AWS DeepRacer Action Space for Beginners</p></figcaption></figure></p><p>④ Enter the name of your car and Choose color. Choose <span style="background-color:#ec7211;border:1px solid;border-radius:3px;font-weight:500;border-color:#e76d0c #e15500 #e15500;text-shadow:rgba(0,0,0,.05)0 1px 0;background-image:linear-gradient(180deg,#f67c1b 0,#e15500);box-shadow:inset 0 1px 0 hsla(0,0%,100%,.2);color:#ffff;padding:0 5px;font-weight:700">Done</span></p><p><br></p><h3 id=action-space>Action Space</h3><p>You car can turn left, turn right, move forward at different speeds. All these choice become the action spaces of the Car.
Action space of a Car depends on following parameters:</p><ol><li><strong>Maximum Steering Angle:</strong> Max values are between 1 and 30.</li><li><strong>Steering angle granularity:</strong> Possible values are 3, 5 and 7</li><li><strong>Maximum speed:</strong> Select values between 0.1m/s and 4m/s.</li><li><strong>Speed granularity:</strong> Possible values are 1, 2 and 3</li></ol><p>If you choose 5 <em>Steering angles granularity</em> and 3 <em>Speeds granularity</em> then it has total (5*3) = 15 action spaces <em>(all combinations of angles vs speed)</em>. A car choose random action out of these 15 action spaces in its trail and errors.</p><pre><code>  Action Space = Steering angles granularity * Speeds granularity
</code></pre><p>Note that more the action spaces, more the choices a Car has to choose from. You might get the best finishing time and best time around the curve with more action spaces but it requires a lot of training and your Car might not reach the convergence (finish the racing track). Same is applicable for maximum speed.</p><p>As a beginner, it is advised to use:</p><ul><li>3 steering angles and 3 speeds to start with (3*3) = 9 action spaces</li><li>maximum speed to 1m/s to train your car faster.</li></ul><p>Your primary focus while training your car should be on the accuracy and reliability of your model and not the speed or lap time of your Car. Once you have some insights, you can train your car by increasing the action spaces and max speed.</p><h2 id=3-create-model>3. Create Model</h2><p>There are five out of the box models available to use in AWS DeepRacer:</p><div class=table-scroll><table><thead><tr><th align=left>Name</th><th align=left>Description</th><th align=left>Status</th><th align=left>Sensors</th></tr></thead><tbody><tr><td align=left><span style=color:blue>Sample-Head-to-Head</span></td><td align=left>Model trained with reward function for head to head racing</td><td align=left>Ready</td><td align=left>Stereo camera, Lidar</td></tr><tr><td align=left><span style=color:blue>Sample-Object-Avoidance</span></td><td align=left>Model trained with reward function that avoids objects</td><td align=left>Ready</td><td align=left>Stereo camera</td></tr><tr><td align=left><span style=color:blue>Sample-Time-Trial-PreventZigZag</span></td><td align=left>Model trained with reward function that penalizes the agent for steering too much</td><td align=left>Ready</td><td align=left>Camera</td></tr><tr><td align=left><span style=color:blue>Sample-Time-Trial-StayOnTrack</span></td><td align=left>Model trained with reward function that incentivizes the agent to stay inside the track borders</td><td align=left>Ready</td><td align=left>Stereo camera</td></tr><tr><td align=left><span style=color:blue>Sample-Time-Trial-FollowCenterLine</span></td><td align=left>Model trained with reward function that incentivizes the agent to follow the center line</td><td align=left>Ready</td><td align=left>Camera</td></tr></tbody></table></div><p>I recommend to click on each model, Go to their <code>Training Configuration</code> ➞ <code>Reward Function</code> and <code>Action Space</code> which will give you an idea on how to design your own model.</p><p>Let&rsquo;s create our own model:</p><p>① Go to <code>AWS DeepRacer</code> ➞ <code>Reinforcement Learning</code> ➞ <code>Your models</code> and Choose <span style="background-color:#ec7211;border:1px solid;border-radius:3px;font-weight:500;border-color:#e76d0c #e15500 #e15500;text-shadow:rgba(0,0,0,.05)0 1px 0;background-image:linear-gradient(180deg,#f67c1b 0,#e15500);box-shadow:inset 0 1px 0 hsla(0,0%,100%,.2);color:#ffff;padding:0 5px;font-weight:700">Create Model</span></p><p>② Enter Model name and description</p><p>③ Choose a Racing Track. To follow with me, Choose <strong>⦿ re:Invent 2018</strong> and Choose <span style="background-color:#ec7211;border:1px solid;border-radius:3px;font-weight:500;border-color:#e76d0c #e15500 #e15500;text-shadow:rgba(0,0,0,.05)0 1px 0;background-image:linear-gradient(180deg,#f67c1b 0,#e15500);box-shadow:inset 0 1px 0 hsla(0,0%,100%,.2);color:#ffff;padding:0 5px;font-weight:700">Next</span></p><p>④ Choose a Race Type. To follow with me, Choose <strong>⦿ Time trial</strong></p><p>⑤ Choose an Agent (Car). To follow with me, Choose a car which we created earlier. Alternatively Choose default car &ldquo;The Original DeepRacer&rdquo;</p><p>⑥ Clear Reward Function Code Editor. Copy and Paste following reward function in code editor and Click <code>Validate</code> to make sure this code is valid.</p><script type=application/javascript src=https://gist.github.com/ashishlahoti/bf0b8cfeff63ac93a628f628f4d810c0.js></script><p>⑦ Keep the default setting of Training Algorithm <strong>⦿ PPO</strong> and hyperparameters.</p><p>⑧ Enter Stop Condition ➞ Maximum time = 60 minutes.</p><p><strong>Note:</strong> Congratulations, You&rsquo;ve configured your model. Next step is to create, train and evaluate your model. Please note that you have not charged anything till this point. <strong>Subsequent steps will charge you money based on AWS resource utilization.</strong></p><p>⑨ Once you choose <span style="background-color:#ec7211;border:1px solid;border-radius:3px;font-weight:500;border-color:#e76d0c #e15500 #e15500;text-shadow:rgba(0,0,0,.05)0 1px 0;background-image:linear-gradient(180deg,#f67c1b 0,#e15500);box-shadow:inset 0 1px 0 hsla(0,0%,100%,.2);color:#ffff;padding:0 5px;font-weight:700">Create Model</span>. AWS resources will be provisioned to train your model for 60 minutes.</p><p><br></p><h3 id=reward-graph>Reward Graph</h3><p>It is recommended to watch the reward graph and simulator video stream while your car is training. This was a thrilling experience for me to watch the live training of car using my first ever machine learning model.</p><figure class=center><img src=/img/aws/aws-deepracer-model-training.png alt="AWS DeepRacer Reward Graph and Simulator Video Stream"><figcaption><p>AWS DeepRacer Reward Graph and Simulator Video Stream</p></figcaption></figure><p>You should know how to read the reward graph in order to understand your model behavior:</p><ul><li><strong>Average Reward</strong> is reward points your car is accumulating in each attempt. Average reward line should go up linearly in the perfect scenario but this is rare. This is what you should look:<ul><li><em>Average Reward</em> line should go up in the longer time period. That means your car is able to learn from its past failures and able to accumulate more reward points in subsequent attempts.</li><li>If <em>Average Reward</em> line go down in shorter period then do not worry. That means your car is trying to attempt those directions which return less reward points. Your car would learn from those attempts and won&rsquo;t try them again in subsequent attempts.</li></ul></li><li>There are two phases when your car is training, you will notice them if you are watching simulator video:<ul><li><strong>Training Phase</strong>: Your car trains on different parts of the racing track by starting at random positions.</li><li><strong>Evaluating Phase</strong>: You car starts from the starting point of racing track and try to complete the track.</li></ul></li><li><strong>Average percentage completion (Training)</strong> is percentage of track completed in training phase. Since in training phase, main aim of car is to train at different parts of the track, it doesn&rsquo;t complete the track most of the time and hence the graph line remain below and doesn&rsquo;t touch 100% marker.</li><li><strong>Average percentage completion (Evaluating)</strong> is percentage of track completed in evaluating phase. Since in evaluating phase, main aim of car is to complete the track, it should touch the 100% marker and able to finish the racing track. If this graph line is not touching 100% marker then there are higher chances of your model failing in actual race.<br><br></li></ul><h3 id=hyperparameters>Hyperparameters</h3><p>Tuning the hyperparameters can improve the quality of your model but it requires a steep learning curve and a lot of trials and errors. As a beginner, it is advised to use default optimized parameters but at the same time, it is good to know how they impact the training of your Car.</p><ul><li><strong>Number of episodes per iteration:</strong> Each attempt made by car in training phase is one episode. With Default value, a Car make 20 attempts in one iteration before updating training data to the network.</li><li><strong>Batch Size:</strong> Iterations runs in batches. Batch size controls, how many iterations to be completed before updating training data to the network.</li><li><strong>Number of Epochs:</strong> Number of times to repeat the batches and send optimized training data to network. Larger number of epochs is acceptable when the batch size is large.</li><li><strong>Learning Rate:</strong> Controls the speed your car learns. Large learning rate prevents training data from reaching optimal solution whereas Small learning rate takes longer to learn.</li><li><strong>Entropy:</strong> It is a degree of randomness in the Car&rsquo;s action. Larger the entropy means the more random actions a Car will take for exploration.</li><li><strong>Discount Factor:</strong> It is a factor specifies how much of the future reward contributes to the expected rewards. With larger discount factor, Car looks further into the future to consider rewards. With smaller discount factor, Car only consider immediate rewards.</li></ul><p>Take a quick look at hyperparameters:</p><div class=table-scroll><table><thead><tr><th align=left>Hyperparamter</th><th align=left>Advantage of higher values</th><th align=left>Disadvantage of higher values</th><th align=left>Default</th></tr></thead><tbody><tr><td align=left>Batch Size</td><td align=left>More stable updates</td><td align=left>Slower training</td><td align=left>64</td></tr><tr><td align=left>Number of Epochs</td><td align=left>More stable updates</td><td align=left>Slower training</td><td align=left>10</td></tr><tr><td align=left>Learning Rate</td><td align=left>Car learns faster</td><td align=left>May struggle to converge</td><td align=left>0.0003</td></tr><tr><td align=left>Entropy</td><td align=left>More experimental may lead to better results</td><td align=left>May struggle to converge</td><td align=left>0.01</td></tr><tr><td align=left>Discount Factor</td><td align=left>Model looks farther out</td><td align=left>Slower training</td><td align=left>0.999</td></tr><tr><td align=left>Episodes</td><td align=left>Improves model stability</td><td align=left>Slower training</td><td align=left>20</td></tr></tbody></table></div><h2 id=personal-experience>Personal Experience</h2><p>When i started making my first model, I thought that i will make my first model as master piece. I selected max out configuration i.e. max speed 4m/s and maximum action spaces and training period as 2 hours. It failed miserably. It was not able to finish the track even in 2 hours training period and the reward graphs were all going in wrong direction.</p><p>After that I used the model configuration and reward function as mentioned in the post and able to finish the track in 60 min training time. I, then increased the max-speed from 1m/s to 1.5m/s and able to finish the reInvent:2018 track in <strong>~19 seconds</strong>.</p><p>I recommend:-</p><ul><li>Make you model with above example.</li><li>Learn from the reward graph and simulator video.</li><li>Take one step at a time say increase the max-speed from 1m/s to 1.5m/s and train again.</li><li>Continue to progress&mldr;</li></ul><p>Thanks for Reading. I am still in learning phase of AWS DeepRacer and keep updating this post based on my new findings.</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/aws/ rel=tag>AWS</a></li><li class=tags__item><a class="tags__link btn" href=/tags/popular-posts/ rel=tag>Popular Posts</a></li></ul></div></footer></article></main><section class=social-share><ul class=share-icons><li><a href="https://twitter.com/intent/tweet?hashtags=codingnconcepts&url=https%3a%2f%2fcodingnconcepts.com%2faws%2faws-deepracer%2f&text=Build%20Your%20First%20AWS%20DeepRacer%20Model" target=_blank rel=noopener aria-label="Share on Twitter" class="share-btn twitter"><svg class="widget-social__link-icon icon icon-twitter" width="24" height="24" viewBox="0 0 384 312"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5.0-78.8 35.3-78.8 78.8.0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3-6.7 11.6-10.6 25.2-10.6 39.6.0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1.0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4.0-12.6-.4-18.8-1.1 34.9 22.4 76.3 35.4 120.8 35.4 144.9.0 224.1-120 224.1-224.1.0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg><p>Twitter</p></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fcodingnconcepts.com%2faws%2faws-deepracer%2f" target=_blank rel=noopener aria-label="Share on Facebook" class="share-btn facebook"><svg class="widget-social__link-icon icon icon-facebook" width="24" height="24" viewBox="0 0 352 352"><path d="m0 32v288c0 17.5 14.5 32 32 32h288c17.5.0 32-14.5 32-32V32c0-17.5-14.5-32-32-32H32C14.5.0.0 14.5.0 32zm320 0v288h-83V212h41.5l6-48H237v-31c0-14 3.5-23.5 23.5-23.5h26V66c-4.4-.6-19.8-1.5-37.5-1.5-36.9.0-62 22.2-62 63.5v36h-42v48h42v108H32V32z"/></svg><p>Facebook</p></a></li><li><a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fcodingnconcepts.com%2faws%2faws-deepracer%2f&source=https%3a%2f%2fcodingnconcepts.com%2faws%2faws-deepracer%2f&title=Build%20Your%20First%20AWS%20DeepRacer%20Model&summary=Build%20Your%20First%20AWS%20DeepRacer%20Model" target=_blank rel=noopener aria-label="Share on LinkedIn" class="share-btn linkedin"><svg class="widget-social__link-icon icon icon-linkedin" width="24" height="24" viewBox="0 0 352 352"><path d="M0 40v272c0 21.9 18.1 40 40 40h272c21.9.0 40-18.1 40-40V40c0-21.9-18.1-40-40-40H40C18.1.0.0 18.1.0 40zm312-8c4.6.0 8 3.4 8 8v272c0 4.6-3.4 8-8 8H40c-4.6.0-8-3.4-8-8V40c0-4.6 3.4-8 8-8H312zM59.5 87c0 15.2 12.3 27.5 27.5 27.5s27.5-12.3 27.5-27.5S102.2 59.5 87 59.5 59.5 71.8 59.5 87zM187 157h-1v-21h-45v152h47v-75c0-19.8 3.9-39 28.5-39 24.2.0 24.5 22.4 24.5 40v74h47v-83.5c0-40.9-8.7-72-56.5-72C208.5 132.5 193.3 145.1 187 157zM64 288h47.5V136H64V288z"/></svg><p>LinkedIn</p></a></li><li><a href="whatsapp://send?text=Build%20Your%20First%20AWS%20DeepRacer%20Model%2c%20by%20Coding%20N%20Concepts%0aGuide%20to%20build%20your%20first%20AWS%20DeepRacer%20Model%20including%20reward%20function%20code.%0a%0ahttps%3a%2f%2fcodingnconcepts.com%2faws%2faws-deepracer%2f%0a" target=_blank class="share-btn whatsapp"><svg class="widget-social__link-icon icon icon-whatsapp" width="24" height="24" viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3.0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7.0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1.0-5.2 4.2-9.4 9.4-9.4 2.5.0 4.9 1 6.7 2.8s2.8 4.2 2.8 6.7c-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2s0-.5.1-.6.3-.3.4-.5c.2-.1.3-.3.4-.5s0-.4.0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"/></svg><p>Email</p></a></li><li><a href="mailto:?subject=Coding%20N%20Concepts - Build%20Your%20First%20AWS%20DeepRacer%20Model.&body=Build%20Your%20First%20AWS%20DeepRacer%20Model%2c%20by%20Coding%20N%20Concepts%0aGuide%20to%20build%20your%20first%20AWS%20DeepRacer%20Model%20including%20reward%20function%20code.%0a%0ahttps%3a%2f%2fcodingnconcepts.com%2faws%2faws-deepracer%2f%0a" target=_blank class="share-btn email"><svg class="widget-social__link-icon icon icon-mail" width="24" height="24" viewBox="0 0 416 288"><path d="m0 16v256 16h16 384 16v-16V16 0h-16H16 0zm347 16-139 92.5L69 32zM199 157.5l9 5.5 9-5.5L384 46v210H32V46z"/></svg><p>Email</p></a></li></ul></section><div class=related_post_section><h2 class=related_post_title>See Also</h2><ul class=related_post><li><a href=/aws/how-to-create-aws-account/>A Step-by-Step Guide to Create an AWS Account</a></li><li><a href=/post/blockchain-explained/>Blockchain Explained</a></li><li><a href=/post/apache-kafka-ccdak-exam-notes/>Apache Kafka CCDAK Exam Notes</a></li></ul></div><div class="authorbox clearfix"><figure class=authorbox__avatar><img alt="Ashish Lahoti avatar" src=/media/authors/ashishlahoti.png class=avatar height=90 width=90></figure><div class=authorbox__header><span class=authorbox__name>About Ashish Lahoti</span></div><div class=authorbox__description>Ashish Lahoti is a senior application developer at DBS Bank having 10+ years of experience in full stack technologies | Confluent Certified Developer for Apache KAFKA | SCJP Certified</div></div><nav class="post-nav flex"><div class="post-nav__item post-nav__item--next"><a class=post-nav__link href=/aws/how-to-create-aws-account/ rel=next><span class=post-nav__caption>Next&#8201;»</span><p class=post-nav__post-title>A Step-by-Step Guide to Create an AWS Account</p></a></div></nav><section class=comments><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"codingnconcepts"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2021 CodingNConcepts.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>